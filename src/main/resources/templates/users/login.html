<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인 페이지</title>
    <link rel="stylesheet" href="/css/loginpage.css">
    <script>
        // 로그인 버튼 클릭 시 로그인 요청
        function login() {
            const email = document.getElementById("email").value;
            const password = document.getElementById("password").value;

            // 이메일과 비밀번호가 비어있지 않으면 로그인 요청
            if (email && password) {
                // 로그인 처리 (POST 방식)
                fetch("/users/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded"
                    },
                    body: `email=${email}&password=${password}`
                })
                .then(response => {
                    if (response.ok) {
                        // 로그인 성공 시 mainpage로 리다이렉트
                        window.location.href = "/articles";  // mainpage로 리다이렉트
                    } else {
                        alert("로그인 실패! 이메일이나 비밀번호를 확인해주세요.");
                    }
                })
                .catch(error => {
                    console.error("로그인 오류:", error);
                    alert("로그인 중 오류가 발생했습니다.");
                });
            } else {
                alert("이메일과 비밀번호를 입력해주세요.");
            }
        }

        // 로그인 폼을 열기 위한 함수
        function showLogin() {
            const loginContainer = document.getElementById("login-container");
            // 로그인 폼을 flex로 표시
            loginContainer.style.display = "flex";
        }

        // 회원가입 버튼 클릭 시 회원가입 페이지로 이동
        function goToSignUp() {
            window.location.href = "/users/signup";  // 회원가입 페이지로 리다이렉트
        }

        // 페이지가 로드될 때, login-container를 숨기기
        window.onload = function() {
            document.getElementById("login-container").style.display = "none";  // 초기에는 로그인 폼을 숨긴다.
        };
    </script>
</head>
<body>

<!-- 웹 열기 버튼 클릭 시 showLogin() 호출 -->
<button class="open-login-btn" onclick="showLogin()">웹 열기</button>

<div id="login-container" style="display: none;">
    <div class="login-box">
        <h1 class="logo">HOME <span>SAVE</span> HOME</h1>
        <button class="kakao-btn">카카오톡으로 1초만에 시작하기</button>
        <p class="or-text">또는</p>

        <!-- 로그인 폼 -->
        <input type="email" id="email" placeholder="이메일" required>
        <input type="password" id="password" placeholder="비밀번호" required>

        <!-- 로그인 버튼 클릭 시 login() 호출 -->
        <button class="login-btn" onclick="login()">로그인</button>

        <div class="links">
            <a href="#">계정 찾기</a> |
            <a href="#">비밀번호 찾기</a> |
            <!-- 회원가입 버튼 클릭 시 goToSignUp() 호출 -->
            <a href="javascript:void(0)" onclick="goToSignUp()">회원가입</a>
        </div>
    </div>
</div>

</body>
</html>
